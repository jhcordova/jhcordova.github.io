function readSingleFile(e){var t,n=e.target.files[0];n&&((t=new FileReader).onload=function(e){try{var t=new URL(document.getElementById("site").value.trim());displayContents(e.target.result,t.origin)}catch(e){alert(e),location.reload()}},t.readAsText(n))}function readSingleFileThird(e){var t,n=e.target.files[0];n&&((t=new FileReader).onload=function(e){thirdStep(e.target.result)},t.readAsText(n))}function displayContents(e,t){if(""!=document.getElementById("site").value){firstStep(e),secondStep(),document.getElementById("xml").innerHTML=e;for(var n=document.getElementById("xml").getElementsByTagName("img"),a=[],l=0;l<n.length;l++){var o=new URL(n[l].src);n[l].removeAttribute("style"),n[l].src=t+o.pathname,a.push(n[l])}displayIMGS(a,document.getElementById("images")),modal()}else alert("Place the TCS URL >:v"),document.getElementById("file-input").value=""}function modal(){var e=document.getElementById("myModalGallery"),t=document.getElementsByTagName("img"),n=document.getElementById("img01"),a=document.getElementById("caption");for(let l=0;l<t.length;l++)t[l].onclick=function(){e.style.display="block",n.src=this.src,a.innerHTML=this.alt};var l=document.getElementsByClassName("close")[0];l.onclick=function(){e.style.display="none",n.src=""},window.onclick=function(t){t.target==e&&(e.style.display="none",n.src="")}}function displayIMGS(e,t){document.getElementById("count").innerHTML="<h2>Number of images: "+e.length+"</h2>";for(var n=0;n<e.length;n++)t.append(e[n]);setTimeout(scrollClick,500)}function scrollClick(){var e=document.createElement("a");e.setAttribute("href","#second"),e.click()}function firstStep(e){download(e.replace(/.jfif/g,".jpg").replace(/src="\/.+?\/.+?\/.+?\/\.\.\/..\/..\//g,'src="/'),"STEP_ONE.XML")}function secondStep(){document.getElementById("second").innerHTML='<div class="row"> <div class="col"> <p>Download the images at the bottom of the page with simple mass downloader, use the mask below:</p> <p>{url:-2}{url:-1}</p> <p>Change the extention of any image with .jfif to .jpg</p> <p>Once the images have been downloaded and have the correct name, upload them to the net driven platform</p> <p>Place the URL of any of the uploaded images on the text box below, for example, an URL like this: </br> https://106sttireandwheel-key07.ndvrm2.com/Portals/80/xBlog/uploads/2020/11/11/1196aircon1.jpg </p> <textarea id="URL" required="" placeholder="The full URL from an image goes here"></textarea> <p>Process the STEP_ONE.XML file using the button below</p> <input id="file-inputTEXT" accept=".xml" type="file"> </div></div> ',document.getElementById("file-inputTEXT").addEventListener("change",readSingleFileThird,!1)}function removeDots(e){var t=e.split("/"),n=t[t.length-1],a=e.replace(n,""),l=n.split("."),o=l[l.length-1],i=o.splice(0,0,".");o==l[l.length-1]&&l.pop();var c=l.join(".").replace(/\./g,"")+i,r=a+c;return r}function thirdStep(e){try{var t=new URL(document.getElementById("URL").value.trim()).pathname.match(/\/(.+)\//g)[0],n=e,a=n.replace(/src="\/(shared_img)\//g,'src="/'+t+"$1"),l=a.replace(/src="(.+\/)?((.+)\/)(.+\.)(\w+)"/g,'src="'+t+'$3$4$5"'),o=l.replace(/src=".+shared_imgwhat-to-do-after-an-accident.jpg/g,'src="'+t+"shared_imgwhat-to-do-after-an-accident.jpg"),i=o.replace(/(?<=src="[^"]*)\s/g,""),c=i.replace(/<Tags><!\[CDATA\[((.*,){20}).+\/Tags>/g,"<Tags><![CDATA[$1]]></Tags>"),r=c.replace(/(%20)/g,""),d=r.replace(/src="(.+?)"/g,function(e,t){return'src="'+removeDots(t)+'"'});download(d,"UPLOAD_ME.xml"),document.getElementById("third").innerHTML="<h1>YOU ARE DONE, UPLOAD THE XML FILE TO THE NET DRIVEN PLATFORM</h1>",huehuehue()}catch(e){alert(e),document.getElementById("file-inputTEXT").value=""}}function huehuehue(){document.getElementsByClassName("modal-content")[0].innerHTML='<span class="close">&times;</span> <img src="img/dance.gif" alt="HUEHUEUEHEUHE"> <h1>YOU ARE DONE, UPLOAD THE XML FILE TO THE NET DRIVEN PLATFORM</h1>';var e=document.getElementById("myModal"),t=document.getElementsByClassName("close")[0];e.style.display="block",t.onclick=function(){e.style.display="none",location.reload()},window.onclick=function(t){t.target==e&&(e.style.display="none"),location.reload()}}function download(e,t){var n,a,l=new Blob([e],{type:"text/plain;charset=utf-8"});window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(l,t):(n=document.createElement("a"),a=URL.createObjectURL(l),n.href=a,n.download=t,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(a)},0))}String.prototype.splice=function(e,t,n){return this.slice(0,e)+n+this.slice(e+Math.abs(t))};