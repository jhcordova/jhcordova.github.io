function readSingleFile(e){var t,n=e.target.files[0];n&&((t=new FileReader).onload=function(e){try{var url=new URL(document.getElementById("site").value.trim());displayContents(e.target.result,url.origin)}catch(error){alert(error),location.reload()}},t.readAsText(n))}function readSingleFileThird(e){var t,n=e.target.files[0];n&&((t=new FileReader).onload=function(e){thirdStep(e.target.result)},t.readAsText(n))}function displayContents(e,t){if(""!=document.getElementById("site").value){firstStep(e),secondStep(),document.getElementById("xml").innerHTML=e;for(var n=document.getElementById("xml").getElementsByTagName("img"),a=[],l=0;l<n.length;l++){var o=new URL(n[l].src);n[l].removeAttribute("style"),n[l].src=t+o.pathname,a.push(n[l])}displayIMGS(a,document.getElementById("images")),modal()}else alert("Place the TCS URL >:v"),document.getElementById("file-input").value=""}function modal(){var modal=document.getElementById("myModalGallery"),img=document.getElementsByTagName("img"),modalImg=document.getElementById("img01"),captionText=document.getElementById("caption"),span;for(let i=0;i<img.length;i++)img[i].onclick=function(){modal.style.display="block",modalImg.src=this.src,captionText.innerHTML=this.alt};document.getElementsByClassName("close")[0].onclick=function(){modal.style.display="none",modalImg.src=""},window.onclick=function(event){event.target==modal&&(modal.style.display="none",modalImg.src="")}}function displayIMGS(e,t){document.getElementById("count").innerHTML="<h2>Number of images: "+e.length+"</h2>";for(var n=0;n<e.length;n++)t.append(e[n]);setTimeout(scrollClick,500)}function scrollClick(){var click=document.createElement("a");click.setAttribute("href","#second"),click.click()}function firstStep(e){download(e.replace(/.jfif/g,".jpg").replace(/src="\/.+?\/.+?\/.+?\/\.\.\/..\/..\//g,'src="/'),"STEP_ONE.XML")}function secondStep(){document.getElementById("second").innerHTML='<div class="row"> <div class="col"> <p>Download the images at the bottom of the page with simple mass downloader, use the mask below:</p> <p>{url:-2}{url:-1}</p> <p>Change the extention of any image with .jfif to .jpg</p> <p>Once the images have been downloaded and have the correct name, upload them to the net driven platform</p> <p>Place the URL of any of the uploaded images on the text box below, for example, an URL like this: </br> https://106sttireandwheel-key07.ndvrm2.com/Portals/80/xBlog/uploads/2020/11/11/1196aircon1.jpg </p> <textarea id="URL" required="" placeholder="The full URL from an image goes here"></textarea> <p>Process the STEP_ONE.XML file using the button below</p> <input id="file-inputTEXT" accept=".xml" type="file"> </div></div> ',document.getElementById("file-inputTEXT").addEventListener("change",readSingleFileThird,!1)}function removeDots(string){var array=string.split("/"),filename=array[array.length-1],pathNoFilename=string.replace(filename,""),removeDot=filename.split("."),dotextension=removeDot[removeDot.length-1],extension=dotextension.splice(0,0,"."),CLEANfilename,cleanString;return dotextension==removeDot[removeDot.length-1]&&removeDot.pop(),pathNoFilename+(removeDot.join(".").replace(/\./g,"")+extension)}function thirdStep(contents){try{var url=new URL(document.getElementById("URL").value.trim()).pathname,fullFileContent,first,second,third,fourth,fifth,sixth,seveth;download(contents.replace(/src="\/(shared_img)\//g,'src="/'+url+"$1").replace(/src="(.+\/)?((.+)\/)(.+\.)(\w+)"/g,'src="'+url+'$3$4$5"').replace(/src=".+shared_imgwhat-to-do-after-an-accident.jpg/g,'src="'+url+"shared_imgwhat-to-do-after-an-accident.jpg").replace(/(?<=src="[^"]*)\s/g,"").replace(/<Tags><!\[CDATA\[((.*,){20}).+\/Tags>/g,"<Tags><![CDATA[$1]]></Tags>").replace(/(%20)/g,"").replace(/src="(.+?)"/g,(function(match,capture){return'src="'+removeDots(capture)+'"'})),"UPLOAD_ME.xml"),document.getElementById("third").innerHTML="<h1>YOU ARE DONE, UPLOAD THE XML FILE TO THE NET DRIVEN PLATFORM</h1>",huehuehue()}catch(e){alert(e),document.getElementById("file-inputTEXT").value=""}}function huehuehue(){document.getElementsByClassName("modal-content")[0].innerHTML='<span class="close">&times;</span> <img src="img/dance.gif" alt="HUEHUEUEHEUHE"> <h1>YOU ARE DONE, UPLOAD THE XML FILE TO THE NET DRIVEN PLATFORM</h1>';var t=document.getElementById("myModal"),e=document.getElementsByClassName("close")[0];t.style.display="block",e.onclick=function(){t.style.display="none",location.reload()},window.onclick=function(e){e.target==t&&(t.style.display="none"),location.reload()}}function download(e,t){var n,a,l=new Blob([e],{type:"text/plain;charset=utf-8"});window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(l,t):(n=document.createElement("a"),a=URL.createObjectURL(l),n.href=a,n.download=t,document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(a)}),0))}String.prototype.splice=function(idx,rem,str){return this.slice(0,idx)+str+this.slice(idx+Math.abs(rem))};